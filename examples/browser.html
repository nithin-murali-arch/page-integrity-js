<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Integrity JS Example</title>
    <script type="module">
        import { PageIntegrity } from '../dist/index.js';
        
        // Initialize Page Integrity with advanced configuration
        const pageIntegrity = new PageIntegrity({
            strictMode: true,
            blacklistedHosts: ['evil.com', 'malicious.com'],
            whitelistedHosts: ['trusted.com', 'cdn.example.com'],
            allowDynamicInline: true,
            allowedMutations: {
                elementTypes: ['div', 'span', 'p', 'a', 'img'],
                attributes: ['class', 'style', 'src', 'href'],
                patterns: [/^data-.*/]
            },
            onBlocked: (info) => {
                if (info.type === 'unknown-origin') {
                    alert('Script from unknown origin: ' + info.context.origin);
                } else {
                    alert('Blocked event: ' + info.type + '\n' + JSON.stringify(info.context));
                }
            }
        });

        // Start monitoring
        pageIntegrity.start();

        // Example of allowed mutation
        document.getElementById('content').innerHTML += '<p>This is an allowed update</p>';

        // Example of whitelisted script (will be ignored)
        const whitelistedScript = document.createElement('script');
        whitelistedScript.src = 'https://trusted.com/script.js';
        document.body.appendChild(whitelistedScript);

        // Example of blocked script (will be blocked)
        const blockedScript = document.createElement('script');
        blockedScript.src = 'https://evil.com/script.js';
        document.body.appendChild(blockedScript);

        // Example of unknown origin script (will trigger callback, not blocked)
        const unknownScript = document.createElement('script');
        unknownScript.src = 'https://neutral.com/script.js';
        document.body.appendChild(unknownScript);

        // Example of allowed inline script
        const inlineScript = document.createElement('script');
        inlineScript.textContent = 'console.log("This inline script is allowed")';
        document.body.appendChild(inlineScript);
    </script>
</head>
<body>
    <div id="app">
        <h1>Page Integrity JS Example</h1>
        <div id="content">
            <p>This content should only be modified by first-party scripts.</p>
        </div>
    </div>
</body>
</html> 